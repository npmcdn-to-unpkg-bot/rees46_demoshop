h1 Rees46 Demo Store

.row
  - @products.each do |product|
    .col-md-4
      .thumbnail
        h5= link_to product.title, product_path(product)
        = link_to image_tag(product.image.medium, class: "img-responsive"), product_path(product)
        p
          strong= number_to_currency(product.price,  unit: "â‚½ ")
.row
  #recommender_popular

javascript:
  var cf_popular = function(data){
    // jQuery code
    if(data.length > 0) {
      var url = 'store/get_popular_urls';
      $.ajax({
        type: "POST",
        url: 'store/get_popular_urls',
        data: {ids: data, recommender: 'popular'},
      });
      return false;
    }
  };
  function afterInitRees46() {
  var categories_ids = '#{ProductsInfo.new(Order.last.line_items).get_categories_ids}'
  console.log(categories_ids);
  
    REES46.addReadyListener(function () {
      REES46.recommend({
        recommender_type: 'popular',
        category: categories_ids
        }, cf_popular );
      });
  }
