.container
  .row
    .col-xs-5
      hr
      = link_to "Home > ", root_path
      = @product.gender
      hr
      = image_tag @product.image, class: 'img-responsive'
      br
      h3 Brand Name:
      = link_to @product.brand.name, brand_path(@product.brand)
      
      h1 Related Products
      = link_to @product.category.name, category_path(@product.category)

    .col-xs-4
      h1= @product.title
      = @product.description.html_safe
      = simple_form_for @line_item do |f|
        - if @line_item.errors.any?
          #error_explanation
            h2
              = pluralize(@line_item.errors.count, "error")
              |  prohibited this product size from being saved:
            ul
              - @line_item.errors.full_messages.each do |msg|
                li= msg
        .col-md-3
        - if @product.industry == "Fashion"
          = render "industry_fashion", :f => f
          
        - elsif @product.industry == "Cosmetic"
          = render "industry_cosmetic", :f => f
          
        - elsif @product.industry == "Child"
          = render "industry_child", :f => f
          
        = f.input :product_id, as: :hidden, :input_html => { :value => @product.id } if @product.show_product_id?

        h4.col-md-4
          = number_to_currency(@product.price,  unit: "â‚½ ")
          br
          br
          #add-to-cart-button
            = f.submit "Add to Cart"
      .clr
      br
      br

.clr

#recommender_also_bought

.clr

#recommender_similer

.clr

#recommender_interesting

.clr

javascript:
  var cf_also_bought = function(data){
    // jQuery code
    if(data.length > 0) {
      $.ajax({
        type: "POST",
        url: 'get_products_urls',
        data: {ids: data, recommender: 'also_bought'},
      });
      return false;
    } else {
      console.log("Not work or id nil")
      var url = 'get_products_urls';
      $.ajax({
        type: "POST",
        url: 'get_products_urls',
        data: {ids: data, recommender: 'also_bought'},
      });
    }
  };

  var cf_similer = function(data){
    // jQuery code
    if(data.length > 0) {
      $.ajax({
        type: "POST",
        url: 'get_products_urls',
        data: {ids: data, recommender: 'similar'},
      });
      return false;
    } else {
      console.log("Not work or id nil, similar")
      $.ajax({
        type: "POST",
        url: 'get_products_urls',
        data: {ids: data, recommender: 'similar'},
      });
    }
  };

  var cf_interesting = function(data){
    // jQuery code
    if(data.length > 0) {
      var url = 'get_products_urls';
      $.ajax({
        type: "POST",
        url: 'get_products_urls',
        data: {ids: data, recommender: 'interesting'},
      });
      return false;
    }
  };

  function afterInitRees46() {
    var cart_ids = '#{ProductsInfo.new(Order.last.line_items).get_cart_ids}'
    var categories_ids = '#{ProductsInfo.new(Order.last.line_items).get_categories_ids.to_json.html_safe}'
    console.log(cart_ids);
    console.log(categories_ids);

    REES46.addReadyListener(function () {
      REES46.pushData('view', {
        item_id: '#{@product.id}',
        price: '#{@product.price}',
        is_available: '1',
        category_id: '#{@product.category_id}'
      });
    });

    REES46.addReadyListener(function () {
      $('#add-to-cart-button').click(function () {
        REES46.pushData('cart', {
          item_id: '#{@product.id}',
          price: '#{@product.price}',
          is_available: '1',
          category_id: '#{@product.category_id}'
        });
      });
    });

    REES46.addReadyListener(function () {
      REES46.recommend({
        recommender_type: 'also_bought',
        item: '#{@product.id}'
        }, cf_also_bought);
    });

    REES46.addReadyListener(function () {
      REES46.recommend({
        recommender_type: 'similar',
        item: '#{@product.id}',
        cart: cart_ids,
        categories: categories_ids
        }, cf_similer);
    });

    REES46.addReadyListener(function () {
      REES46.recommend({
        recommender_type: 'interesting',
        item: '#{@product.id}'
        }, cf_interesting);
    });
  }
